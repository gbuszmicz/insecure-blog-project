<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Insecure-blog-project by gbuszmicz</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Insecure-blog-project</h1>
      <h2 class="project-tagline">Insecure Web application for testing security and training</h2>
      <a href="https://github.com/gbuszmicz/insecure-blog-project" class="btn">View on GitHub</a>
      <a href="https://github.com/gbuszmicz/insecure-blog-project/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/gbuszmicz/insecure-blog-project/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="insecure-blog-project" class="anchor" href="#insecure-blog-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Insecure Blog Project</h1>

<p>This is an insecure Web application for training and testing Web security. It has multiple vulnerabilities for you to find.</p>

<p align="center">
  <img src="https://raw.githubusercontent.com/gbuszmicz/insecure-blog-project/master/public/images/screenshot.png">
</p>

<h2>
<a id="demo" class="anchor" href="#demo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Demo</h2>

<p>Check it out the <a href="http://insecureblog.herokuapp.com/">demo</a> online. Have fun playing around. And please don't break anything!</p>

<p>I will keep uploading new vulnerabilities. I´ll try to cover all <a href="https://www.owasp.org/index.php/Top_10_2013-Top_10">OWASP Top 10 Common Vulnerabilities</a>, or at least most of them.</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<h4>
<a id="clone-the-repo" class="anchor" href="#clone-the-repo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Clone the repo</h4>

<div class="highlight highlight-source-shell"><pre>$ git clone https://github.com/gbuszmicz/insecure-blog-project.git myApp
$ <span class="pl-c1">cd</span> myApp
$ npm install  <span class="pl-c"># Install Node.js components listed in ./package.json</span></pre></div>

<h4>
<a id="create-a-production-environment-file" class="anchor" href="#create-a-production-environment-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create a production environment file</h4>

<p>If you are planning on running this app in production mode you have to create a file storing all the information about your db:</p>

<div class="highlight highlight-source-shell"><pre>env/production.json</pre></div>

<p>The <em>production.json</em> file has the same structure that env/development.json file plus <em>redis</em> information. For example:</p>

<div class="highlight highlight-source-js"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>mysql<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">"</span>_comment<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>MySQL database running in production mode<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>host<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>somepublichost.cloud.com<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>port<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>33306<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>root<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>password<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>superSecretPassword<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>database<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>insecure_blog<span class="pl-pds">"</span></span>
  },
  <span class="pl-s"><span class="pl-pds">"</span>redis<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
    <span class="pl-s"><span class="pl-pds">"</span>_comment<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Redis to go for production<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>host<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>asjdklasdjlakñsdjañl.redistogo.com<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>port<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>10460<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>pass<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>8192301j1239123jio121<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>url<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>redis://redistogo:8192301j1239123jio121@viperfish.redistogo.com:10460/<span class="pl-pds">"</span></span>
   }
}</pre></div>

<h4>
<a id="starting-the-app" class="anchor" href="#starting-the-app" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Starting the app</h4>

<p>The app use <a href="https://github.com/strongloop/node-foreman">foreman</a>. To start it just run:</p>

<div class="highlight highlight-source-shell"><pre>$ foreman start</pre></div>

<p>You can also start the app without foreman:</p>

<div class="highlight highlight-source-shell"><pre>$ node index.js</pre></div>

<h2>
<a id="user-guide--challenges" class="anchor" href="#user-guide--challenges" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>User guide / Challenges</h2>

<h4>
<a id="sql-injection-sqli" class="anchor" href="#sql-injection-sqli" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SQL injection (SQLi)</h4>

<h5>
<a id="what-is-this-vulnerability-about" class="anchor" href="#what-is-this-vulnerability-about" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is this vulnerability about</h5>

<p>A <a href="https://www.owasp.org/index.php/SQL_Injection">SQL injection</a> attack consists of insertion or "injection" of a SQL query via the input data from the client to the application. A successful SQL injection exploit can read sensitive data from the database, modify database data (Insert/Update/Delete), execute administration operations on the database (such as shutdown the DBMS), recover the content of a given file present on the DBMS file system and in some cases issue commands to the operating system. SQL injection attacks are a type of injection attack, in which SQL commands are injected into data-plane input in order to effect the execution of predefined SQL commands.</p>

<p><strong>The challenge</strong> </p>

<blockquote>
<ul>
<li>
<strong>a.</strong> <strong>Test</strong> the app for <strong>SQLi vulnerabilities</strong> {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/a.Testing_vulnerability.md">answer here</a>},</li>
<li>
<strong>b.</strong> Try to get the <strong>database version</strong> and <strong>name</strong>. Also get the <strong>user</strong> {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/b.Get_database_version.md">answer here</a>},</li>
<li>
<strong>c.</strong> Try to get the <strong>password</strong> for the <strong>database</strong> connector <strong>user</strong> (<em>mysql.user</em>) {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/c.Password_database_user.md">answer here</a>},</li>
<li>
<strong>d.</strong> Get <strong>all the databases</strong> in the server (database engine) {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/d.Get_all_databases.md">answer here</a>},</li>
<li>
<strong>e.</strong> Get <strong>all the tables</strong> for the app database {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/e.Get_all_tables.md">answer here</a>},</li>
<li>
<strong>f.</strong> Get <strong>all the columns</strong> for the table storing the app users {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/f.Get_users_columns.md">answer here</a>},</li>
<li>
<strong>g.</strong> Get <strong>username</strong> and <strong>password</strong> of the app administrator {<a href="https://github.com/gbuszmicz/insecure-blog-project/blob/master/challenges/SQLi/g.Get_app_administrator.md">answer here</a>},</li>
<li>
<strong>h.</strong> Finally <strong>login</strong> into the app with the administrator credentials</li>
</ul>
</blockquote>

<h5>
<a id="how-to-fix-it" class="anchor" href="#how-to-fix-it" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How to fix it</h5>

<p><strong>Solution #1: escape the input.</strong></p>

<p>To fix this vulnerability you have to <strong>escape</strong> the user input <strong>before</strong> pass it to the database. Most database's clients have some sort of <strong>escape function</strong> to accomplish this. 
You can also do it yourself, you only need to know what type of value you are getting from the view or any untrusted source. 
<a href="http://underscorejs.org/">Underscore.js</a> is a good library for this.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// This code is from controllers/ctlPost.js</span>
<span class="pl-c">// db.escape(user input). This is from node-mysql</span>
<span class="pl-c">// db is the mysql connection instance. Check helpers/mysql.js file for more details</span>
<span class="pl-c">//</span>
<span class="pl-c">// var postId = req.params.postid; // =&gt; Old unescaped var!!</span>
<span class="pl-k">var</span> postId <span class="pl-k">=</span> <span class="pl-smi">db</span>.<span class="pl-en">escape</span>(<span class="pl-smi">req</span>.<span class="pl-smi">params</span>.<span class="pl-smi">postid</span>); <span class="pl-c">// New and beautiful escaped var!!</span>
<span class="pl-k">var</span> sql <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>SELECT posts.id, title, body, date, tags, username, firstname, lastname, avatar <span class="pl-pds">"</span></span><span class="pl-k">+</span>
          <span class="pl-s"><span class="pl-pds">"</span>FROM posts INNER JOIN users ON posts.userId = users.id <span class="pl-pds">"</span></span><span class="pl-k">+</span>
          <span class="pl-s"><span class="pl-pds">"</span>WHERE posts.id = <span class="pl-pds">"</span></span> <span class="pl-k">+</span>postId;
<span class="pl-smi">db</span>.<span class="pl-en">query</span>(sql, <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">post</span>) { 
  <span class="pl-k">...</span> 
})</pre></div>

<p><strong>Solution #2: parameterized SQL queries.</strong></p>

<p>Parameterize SQL queries is an even better way to secure your application. Instead of building a SQL statement using concatenation, we let a function replace the parameters within the statement and perform sanitation.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c">// This code is from controllers/ctlPost.js</span>
<span class="pl-k">var</span> postId <span class="pl-k">=</span> <span class="pl-smi">req</span>.<span class="pl-smi">params</span>.<span class="pl-smi">postid</span>; 
<span class="pl-k">var</span> sql <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>SELECT posts.id, title, body, date, tags, username, firstname, lastname, avatar <span class="pl-pds">"</span></span><span class="pl-k">+</span>
          <span class="pl-s"><span class="pl-pds">"</span>FROM posts INNER JOIN users ON posts.userId = users.id <span class="pl-pds">"</span></span><span class="pl-k">+</span>
          <span class="pl-s"><span class="pl-pds">"</span>WHERE posts.id = ?<span class="pl-pds">"</span></span>;
<span class="pl-smi">db</span>.<span class="pl-en">query</span>(sql, [postId], <span class="pl-k">function</span>(<span class="pl-smi">err</span>, <span class="pl-smi">post</span>) { 
  <span class="pl-k">...</span> 
})</pre></div>

<h5>
<a id="more-about-mysql-injection" class="anchor" href="#more-about-mysql-injection" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>More about MySQL Injection</h5>

<ul>
<li><a href="https://www.owasp.org/index.php/SQL_Injection">OWASP - SQL injection</a></li>
<li><a href="http://www.w3schools.com/sql/sql_injection.asp">W3School - SQL Injection</a></li>
<li><a href="http://www.acunetix.com/websitesecurity/sql-injection/">Acunetix- SQL Injection (SQLi)</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet">Pentestmonkey - MySQL SQL Injection Cheat Sheet</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet">Pentestmonkey - MSSQL Injection Cheat Sheet</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet">Pentestmonkey - Postgres SQL Injection Cheat Sheet</a></li>
</ul>

<h2>
<a id="credits" class="anchor" href="#credits" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Credits</h2>

<p>This <strong>README.md</strong> was made with <a href="https://stackedit.io/editor">Stackedit.io</a></p>

<h2>
<a id="be-a-part-of-the-project" class="anchor" href="#be-a-part-of-the-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Be a part of the project</h2>

<p>If you want to submit some code with <strong>vulnerabilities</strong>, or may be try <strong>React</strong> for the views, or pretty much anything you might think, please contact me on <a href="https://twitter.com/gbuszmicz">twitter</a></p>

<h2>
<a id="questions-and-issues" class="anchor" href="#questions-and-issues" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Questions and issues</h2>

<p>Feel free to contact me on <a href="https://twitter.com/gbuszmicz">twitter</a> or <a href="https://github.com/gbuszmicz/insecure-blog-project/issues/new">create an issue</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/gbuszmicz/insecure-blog-project">Insecure-blog-project</a> is maintained by <a href="https://github.com/gbuszmicz">gbuszmicz</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
